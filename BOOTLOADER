
#include "stm32f1xx_hal.h"
#include "bootloader.h"

UART_HandleTypeDef huart1;

int main(void)
{
    HAL_Init();
    SystemClock_Config();
    MX_USART1_UART_Init();

    // Small delay to check if update request comes
    uint8_t update_cmd = 0;
    HAL_UART_Receive(&huart1, &update_cmd, 1, 2000);

    if (update_cmd == 0x55) // Example update command
    {
        Bootloader_UART_Download(&huart1);
    }
    else
    {
        Bootloader_JumpToApplication();
    }

    while (1);
}
